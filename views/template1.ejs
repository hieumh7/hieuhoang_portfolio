<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Valentine's Day</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Agbalumo&family=Cormorant+Upright:wght@300;400;500;600;700&family=Dancing+Script&family=Luckiest+Guy&family=Playwrite+DE+SAS:wght@100..400&family=Send+Flowers&display=swap" rel="stylesheet">
    <style>
        body {
            background: url("/img/background.png") no-repeat center center/cover;
            text-align: center;
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
            overflow: hidden;
        }
        h1 {
            font-size: 1.5rem;
            margin: 10px;
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.8);
            color: #fff;
            font-size: 4rem;
            font-family: "Agbalumo", serif;
  font-weight: 400;
  font-style: normal;
        }
        .video-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            width: 80%;
            max-width: 1000px;
            justify-content: center;
            align-items: center;
        }
        .video-container video {
            max-width: 300px;
            justify-self: center;
            align-self: center;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(255, 255, 255, 0.5);
            border: 4px solid #BB0000; /* Viền đỏ đậm như giấy thư */
    border-radius: 15px;
        }
        .video-container img {
            max-width: 300px;
            justify-self: center;
            align-self: center;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(255, 255, 255, 0.5);
            border: 4px solid #BB0000; /* Viền đỏ đậm như giấy thư */
    border-radius: 15px;
        }

        video {
            width: 80%;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(255, 255, 255, 0.5);
        }

        /* Màn hình chào */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url("/img/background1.png") no-repeat center center/cover;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            font-size: 1.5rem;
            z-index: 10;
            flex-direction: column;
            padding: 20px;
        }
        .overlay::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: -1;
        }
        .overlay h2 {
            margin-bottom: 10px;
            color: #111;
            margin-top: 10px;
            font-size: 4rem;
            font-family: "Agbalumo", serif;
  font-weight: 400;
  font-style: normal;
        }
        .overlay p {
            font-size: 1.3rem;
            color: #111;
            font-family: "Playwrite DE SAS", serif;
  font-optical-sizing: auto;
  font-weight: 300;
  font-style: normal;
        }
        /* Ẩn GIF khi chưa click */
        #countdown {
            display: none;
            width: 200px;
            height: auto;
        }
        #main-content {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            width: 100vw;
        }
        #countdown-timer {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 3rem;
    font-weight: bold;
    color: white;
    text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.8);
    z-index: 20;
    display: none;
}

#special-text {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    display: none;
    z-index: 20;
    font-size: 3rem;
            font-family: "Playwrite DE SAS", serif;
  font-optical-sizing: auto;
  font-weight: 300;
  font-style: normal;
}
#special-text2 {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    display: none;
    z-index: 20;
    font-size: 3rem;
            font-family: "Playwrite DE SAS", serif;
  font-optical-sizing: auto;
  font-weight: 300;
  font-style: normal;
}

#special-image {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 300px;
    height: auto;
    z-index: 20;
    box-shadow: 0px 0px 20px rgba(255, 255, 255, 0.8);
    border-radius: 10px;
}
#background-blur {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8); /* Làm mờ nền */
    z-index: 15;
    display: none;
}
.valentine-box {
    background: url("/img/background6.png") no-repeat center center/cover;
    width: 700px; /* Đặt giới hạn chiều rộng */
    padding: 20px;
    border: 5px solid #AA0000; /* Viền đỏ đậm như giấy thư */
    border-radius: 15px; /* Bo góc mềm mại */
    box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2); /* Tạo độ nổi */
    text-align: center;
    word-wrap: break-word;
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

        .valentine-box-title {
            width: 550px; /* Đặt giới hạn chiều rộng */
            text-align: center;
        }
        .valentine-footer {
    width: 95%; /* Giảm bớt chiều rộng để không bị tràn */
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%); /* Căn giữa footer bên trong valentine-box */
    display: flex;
    justify-content: space-between;
}

.bottom-left, .bottom-right {
    font-size: 1.3rem;
    color: #111;
    font-family: "Playwrite DE SAS", serif;
    font-weight: 300;
    font-style: normal;
    white-space: nowrap; /* Tránh xuống dòng */
    padding: 5px 10px;
}
.click-text {
    margin-bottom: 1.9rem;
}


    </style>
</head>
<body>
    <!-- Màn hình chào -->
    <div class="overlay" id="overlay">
        <div class="valentine-box">
            <div class="valentine-box-title">
                <h2><%= title %></h2>
            </div>
        <p><%= body %></p>
        <p class="click-text">Click vào màn hình để tiếp tục</p>
        <img id="countdown" src="/img/countdown.gif" alt="Countdown">
        <div class="valentine-footer">
            <div class="bottom-left">Gửi: <%= to %></div>
            <div class="bottom-right">Tới: <%= from %></div>
        </div>
        </div>
        
    </div>
    

    <!-- Nội dung chính -->
    <div id="main-content">
        <h1><%= title %>❤️</h1>
        <div class="video-container">
            <!-- <% const videos = ["soda1.mp4", "soda2.mp4", "soda3.mp4", "soda4.mp4", "soda5.mp4", "soda6.mp4"]; %>
            <% videos.forEach(video => { %>
                <video muted playsinline preload="none">
                    <source src="/img/<%= video %>" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            <% }); %> -->
            <% [mediaPath, mediaPath1, mediaPath2].forEach(path => { %>
                <% if (path) { %>
                    <% if (path.endsWith('.mp4')) { %>
                        <video muted playsinline preload="none">
                            <source src="<%= path %>" type="video/mp4">
                        </video>
                    <% } else { %>
                        <img src="<%= path %>"  alt="Uploaded media">
                    <% } %>
                <% } %>
            <% }) %>
        </div>
        <div id="background-blur"></div>
        <div id="countdown-timer"></div>
        <div id="special-text"><%= text1 %></div>
        <div id="special-text2"><%= text2 %></div>
        <img id="special-image" src="" alt="Special Image">



        <audio id="background-music" loop>
            <source src="/img/sound.mp4" type="audio/mp4">
        </audio>
    </div>

    <script>
        function openFullscreen() {
            const elem = document.documentElement;
            if (elem.requestFullscreen) {
                elem.requestFullscreen();
            } else if (elem.mozRequestFullScreen) { // Firefox
                elem.mozRequestFullScreen();
            } else if (elem.webkitRequestFullscreen) { // Chrome, Safari, Opera
                elem.webkitRequestFullscreen();
            } else if (elem.msRequestFullscreen) { // IE/Edge
                elem.msRequestFullscreen();
            }
        }
    
        document.addEventListener("click", () => {
            openFullscreen(); // Bật full màn hình khi nhấp vào trang
    
            const overlay = document.getElementById("overlay");
            const countdown = document.getElementById("countdown");
            const mainContent = document.getElementById("main-content");
    
            // Hiển thị GIF
            countdown.style.display = "block";
    
            // Sau 3 giây, ẩn overlay và hiện nội dung chính
            setTimeout(() => {
                overlay.style.display = "none";
                mainContent.style.display = "flex";
    
                // Bắt đầu phát video và nhạc
                document.querySelectorAll("video").forEach(video => {
                    video.play();
                });
                
                
                const audio = document.getElementById("background-music");
                if (audio.paused) {
                    audio.play();
                }
    
                setTimeout(() => {
                    const countdownTimer = document.getElementById("countdown-timer");
                    countdownTimer.style.display = "block";
    
                    let count = 10;
                    const countdownInterval = setInterval(() => {
                        countdownTimer.textContent = count;
                        if (count === 0) {
                            clearInterval(countdownInterval);
                            countdownTimer.style.display = "none";
    
                            // Làm mờ nền
                            document.getElementById("background-blur").style.display = "block";
    
                            // Hiển thị chữ "Hết rồi yêu lắm"
                            const specialText = document.getElementById("special-text");
                            specialText.style.display = "block";
    
                            setTimeout(() => {
    specialText.style.display = "none";

    // Lấy danh sách ảnh từ EJS
    const imagePaths = ["<%= mediaPath3 %>", "<%= mediaPath4 %>", "<%= mediaPath5 %>"];
    let currentImageIndex = 0;

    // Hiển thị ảnh đầu tiên nếu có
    const specialImage = document.getElementById("special-image");
    if (imagePaths[0]) {
        specialImage.src = imagePaths[currentImageIndex];
        specialImage.style.display = "block";
    }

    // Hàm đổi ảnh tự động
    const changeImage = () => {
        currentImageIndex++;
        if (currentImageIndex < imagePaths.length && imagePaths[currentImageIndex]) {
            specialImage.src = imagePaths[currentImageIndex];
            setTimeout(changeImage, 2000);
        } else {
            // Ẩn ảnh sau khi hiển thị đủ số ảnh
            setTimeout(() => {
                specialImage.style.display = "none";
                const specialText2 = document.getElementById("special-text2");
                specialText2.style.display = "block";

                // Chuyển hướng khi click
                document.addEventListener("click", () => {
                    window.location.href = "https://www.facebook.com/messages/t/hieufall";
                });
            }, 2000);
        }
    };

    // Bắt đầu đổi ảnh sau 2 giây
    setTimeout(changeImage, 2000);
}, 2500);

                        }
                        count--;
                    }, 1000);
                }, 1000);
    
            }, 6000); // Thời gian delay theo countdown
        }, { once: true }); // Đảm bảo chỉ chạy 1 lần
    </script>
    
</body>
</html>
